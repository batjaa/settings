#!/usr/bin/env bash

# Find defaults settings: https://pawelgrzybek.com/change-macos-user-preferences-via-command-line/
# defaults read > before.defaults
# defaults read > after.defaults
# diff before.defaults after.defaults

# Compatible with macOS Sequoia (15.x) and Tahoe (16.x)
# Last updated: December 2025

# Close any open System Preferences panes, to prevent them from overriding
# settings we’re about to change
osascript -e 'tell application "System Preferences" to quit'

# Ask for the administrator password upfront
sudo -v

# Keep-alive: update existing `sudo` time stamp until `.macos` has finished
while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

###############################################################################
# General UI/UX                                                               #
###############################################################################

# Disable the sound effects on boot
sudo nvram SystemAudioVolume=" "

# Remove ui sound
defaults write NSGlobalDomain com.apple.sound.uiaudio.enabled -bool false

# Set sidebar icon size to medium
defaults write NSGlobalDomain NSTableViewDefaultSizeMode -int 2

# Increase window resize speed for Cocoa applications
defaults write NSGlobalDomain NSWindowResizeTime -float 0.001

# Expand save panel by default
defaults write NSGlobalDomain NSNavPanelExpandedStateForSaveMode -bool true
defaults write NSGlobalDomain NSNavPanelExpandedStateForSaveMode2 -bool true

# Expand print panel by default
defaults write NSGlobalDomain PMPrintingExpandedStateForPrint -bool true
defaults write NSGlobalDomain PMPrintingExpandedStateForPrint2 -bool true

# Save to disk (not to iCloud) by default
defaults write NSGlobalDomain NSDocumentSaveNewDocumentsToCloud -bool false

# Automatically quit printer app once the print jobs complete
defaults write com.apple.print.PrintingPrefs "Quit When Finished" -bool true

# Disable the “Are you sure you want to open this application?” dialog
defaults write com.apple.LaunchServices LSQuarantine -bool false

# Remove duplicates in the “Open With” menu (also see `lscleanup` alias)
/System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework/Support/lsregister -kill -r -domain local -domain system -domain user

# Disable automatic capitalization as it’s annoying when typing code
defaults write NSGlobalDomain NSAutomaticCapitalizationEnabled -bool false

# Disable smart dashes as they’re annoying when typing code
defaults write NSGlobalDomain NSAutomaticDashSubstitutionEnabled -bool false

# Disable automatic period substitution as it’s annoying when typing code
defaults write NSGlobalDomain NSAutomaticPeriodSubstitutionEnabled -bool false

# Disable smart quotes as they’re annoying when typing code
defaults write NSGlobalDomain NSAutomaticQuoteSubstitutionEnabled -bool false

# Disable auto-correct
defaults write NSGlobalDomain NSAutomaticSpellingCorrectionEnabled -bool false

# Disable inline predictive text (annoying for coding)
defaults write NSGlobalDomain NSAutomaticInlinePredictionEnabled -bool false

# Disable default shortcuts to avoid conflicts with Hammerspoon and coding
# This disables Mission Control, Spaces, and other keyboard shortcuts
# that might conflict with custom window management (Ctrl+Alt+Cmd combinations)
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 118 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 18, 262144);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 119 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 18, 262144);
    };
}"
plutil -replace AppleSymbolicHotKeys.15.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.16.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.164.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.17.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.175.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.18.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.184.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.19.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 190 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (113, 12, 8388608);
    };
}"
plutil -replace AppleSymbolicHotKeys.20.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.21.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.22.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.222.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.23.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.24.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 240 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 241 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 242 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 243 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 248 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 249 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
plutil -replace AppleSymbolicHotKeys.25.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 250 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8781824);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 251 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8781824);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 256 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8781824);
    };
}"
plutil -replace AppleSymbolicHotKeys.26.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 260 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 53, 1048576);
    };
}"
plutil -replace AppleSymbolicHotKeys.28.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.29.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.30.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.31.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.32.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 33 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 125, 8650752);
    };
}"
plutil -replace AppleSymbolicHotKeys.36.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.52.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.60.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.64.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist
plutil -replace AppleSymbolicHotKeys.65.enabled -bool NO ~/Library/Preferences/com.apple.symbolichotkeys.plist

defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 61 "{
    enabled = 1;
    value = {
        type = standard;
        parameters = (32, 49, 1572864);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 79 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
plutil -replace AppleSymbolicHotKeys.80.enabled -bool YES ~/Library/Preferences/com.apple.symbolichotkeys.plist
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 81 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 123, 8650752);
    };
}"
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 82 "{
    enabled = 1;
    value = {
        type = standard;
        parameters = (65535, 124, 8781824);
    };
}"

# Disable Input Source switching shortcuts (conflicts with Option key app launching)
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 59 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (32, 49, 262144);
    };
}"

# Disable Spotlight shortcuts (conflicts with Cmd+Space, use Alfred instead)
defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add 64 "{
    enabled = 0;
    value = {
        type = standard;
        parameters = (65535, 49, 1048576);
    };
}"

# Additional shortcuts for Hammerspoon compatibility
# Disable all function key shortcuts that might conflict
for i in {160..175}; do
  defaults write com.apple.symbolichotkeys AppleSymbolicHotKeys -dict-add $i "{
    enabled = 0;
  }"
done


###############################################################################
# Trackpad, mouse, keyboard, Bluetooth accessories, and input                 #
###############################################################################

# Trackpad: enable tap to click for this user and for the login screen
defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad Clicking -bool false
defaults write com.apple.dock showAppExposeGestureEnabled -int 1
defaults -currentHost write NSGlobalDomain com.apple.mouse.tapBehavior -int 0
defaults write NSGlobalDomain com.apple.mouse.tapBehavior -int 0

# Disable “natural” (Lion-style) scrolling
defaults write NSGlobalDomain com.apple.swipescrolldirection -bool false

# Increase sound quality for Bluetooth headphones/headsets
defaults write com.apple.BluetoothAudioAgent "Apple Bitpool Min (editable)" -int 40

# Enable full keyboard access for all controls
# (e.g. enable Tab in modal dialogs)
defaults write NSGlobalDomain AppleKeyboardUIMode -int 3

# Disable press-and-hold for keys in favor of key repeat
defaults write NSGlobalDomain ApplePressAndHoldEnabled -bool false

# Set a blazingly fast keyboard repeat rate
defaults write NSGlobalDomain KeyRepeat -int 1
defaults write NSGlobalDomain InitialKeyRepeat -int 13

# Set language and text formats
# Note: if you’re in the US, replace `EUR` with `USD`, `Centimeters` with
# `Inches`, `en_GB` with `en_US`, and `true` with `false`.
defaults write NSGlobalDomain AppleLanguages -array "en" "mn"

# Add MN-Cyrilic keyboard layout
defaults write com.apple.HIToolbox AppleEnabledInputSources -array-add '<dict><key>InputSourceKind</key><string>Keyboard Layout</string><key>KeyboardLayout ID</key><integer>-2276</integer><key>KeyboardLayout Name</key><string>Mongolian-Cyrillic</string></dict>'

# Disable Globe key showing emojis
defaults write com.apple.HIToolbox AppleFnUsageType -int 0

# Use Fx keys default to function keys
defaults write NSGlobalDomain "com.apple.keyboard.fnState" -int 1

# Show language menu in the top right corner of the boot screen
sudo defaults write /Library/Preferences/com.apple.loginwindow showInputMenu -bool true

# Set the timezone; see `sudo systemsetup -listtimezones` for other #values
#sudo systemsetup -settimezone "Europe/Brussels" > /dev/null

###############################################################################
# Energy saving                                                               #
###############################################################################

# Display sleep times (must be lower than system sleep)
# -b = battery, -c = charging/AC power, -a = all
sudo pmset -b displaysleep 5    # Display sleeps after 5 min on battery
sudo pmset -c displaysleep 15   # Display sleeps after 15 min while charging

# System sleep times
sudo pmset -b sleep 10           # System sleeps after 10 min on battery
sudo pmset -c sleep 0            # Never sleep while charging (good for dev work)

###############################################################################
# Display & Performance (useful for stock trading & photo editing)           #
###############################################################################

# Enable HiDPI display modes (requires restart)
sudo defaults write /Library/Preferences/com.apple.windowserver DisplayResolutionEnabled -bool true

# Disable transparency in menu bar and elsewhere (performance boost)
defaults write com.apple.universalaccess reduceTransparency -bool true

# Disable window animations (faster performance)
defaults write NSGlobalDomain NSAutomaticWindowAnimationsEnabled -bool false

# Speed up expose animation
defaults write com.apple.dock expose-animation-duration -float 0.15

###############################################################################
# Screen                                                                      #
###############################################################################

# Require password immediately after sleep or screen saver begins
defaults write com.apple.screensaver askForPassword -int 1
defaults write com.apple.screensaver askForPasswordDelay -int 0

# Save screenshots to the desktop
defaults write com.apple.screencapture location -string "${HOME}/Desktop"

# Disable shadow in screenshots
defaults write com.apple.screencapture disable-shadow -bool true

# Set screenshot format to PNG (best quality for technical screenshots)
defaults write com.apple.screencapture type -string "png"

# Include date in screenshot filenames
defaults write com.apple.screencapture include-date -bool true

# Enable subpixel font rendering on non-Apple LCDs
# Reference: https://github.com/kevinSuttle/macOS-Defaults/issues/17#issuecomment-266633501
defaults write NSGlobalDomain AppleFontSmoothing -int 1

# Default clock format
defaults write com.apple.menuextra.clock DateFormat -string "MMM d h:mm a"

###############################################################################
# Developer Settings                                                          #
###############################################################################

# Disable the crash reporter
defaults write com.apple.CrashReporter DialogType -string "none"

# Enable full file path in title bar
defaults write com.apple.finder _FXShowPosixPathInTitle -bool true

# Show ~/Library folder (useful for developers)
chflags nohidden ~/Library

# Disable Time Machine prompts when attaching new disks
defaults write com.apple.TimeMachine DoNotOfferNewDisksForBackup -bool true

# Increase max file watches (useful for webpack, gulp, grunt, etc.)
# Note: This requires editing /Library/LaunchDaemons/limit.maxfiles.plist
# echo kern.maxfiles=65536 | sudo tee -a /etc/sysctl.conf
# echo kern.maxfilesperproc=65536 | sudo tee -a /etc/sysctl.conf

# Speed up wake from sleep (delay standby mode for 24 hours)
# This prevents the Mac from entering deep sleep too quickly
sudo pmset -a standbydelay 86400

###############################################################################
# Finder                                                                      #
###############################################################################

# Finder: disable window animations and Get Info animations
defaults write com.apple.finder DisableAllAnimations -bool true

# Set Desktop as the default location for new Finder windows
# For other paths, use `PfLo` and `file:///full/path/here/`
defaults write com.apple.finder NewWindowTarget -string "PfDe"
defaults write com.apple.finder NewWindowTargetPath -string "file://${HOME}/Desktop/"

# Finder: show all filename extensions
defaults write NSGlobalDomain AppleShowAllExtensions -bool true

# Finder: show status bar
defaults write com.apple.finder ShowStatusBar -bool true

# Finder: show path bar
defaults write com.apple.finder ShowPathbar -bool true

# Keep folders on top when sorting by name
defaults write com.apple.finder _FXSortFoldersFirst -bool true

# When performing a search, search the current folder by default
defaults write com.apple.finder FXDefaultSearchScope -string "SCcf"

# Disable the warning when changing a file extension
defaults write com.apple.finder FXEnableExtensionChangeWarning -bool false

# Avoid creating .DS_Store files on network or USB volumes
defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool true
defaults write com.apple.desktopservices DSDontWriteUSBStores -bool true

# Enable snap-to-grid for icons on the desktop and in other icon views
/usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:arrangeBy grid" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:arrangeBy grid" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:arrangeBy grid" ~/Library/Preferences/com.apple.finder.plist

# Increase grid spacing for icons on the desktop and in other icon views
/usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:gridSpacing 100" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:gridSpacing 100" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:gridSpacing 100" ~/Library/Preferences/com.apple.finder.plist

# Increase the size of icons on the desktop and in other icon views
/usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:iconSize 80" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:iconSize 80" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:iconSize 80" ~/Library/Preferences/com.apple.finder.plist

# Use list view in all Finder windows by default
# Four-letter codes for the other view modes: `icnv`, `clmv`, `glyv`
defaults write com.apple.finder FXPreferredViewStyle -string "Nlsv"

# Remove quarantine attributes from ~/Library
xattr -d com.apple.FinderInfo ~/Library 2>/dev/null || true

# Expand the following File Info panes:
# “General”, “Open with”, and “Sharing & Permissions”
defaults write com.apple.finder FXInfoPanesExpanded -dict \
	General -bool true \
	OpenWith -bool true \
	Privileges -bool true

###############################################################################
# Dock, Dashboard, and hot corners                                            #
###############################################################################

# Set the icon size of Dock items to 18 pixels
defaults write com.apple.dock tilesize -int 18

# Change minimize/maximize window effect
defaults write com.apple.dock mineffect -string "scale"

# Enable spring loading for all Dock items
defaults write com.apple.dock enable-spring-load-actions-on-all-items -bool true

# Wipe all (default) app icons from the Dock
# This is only really useful when setting up a new Mac, or if you don’t use
# the Dock to launch apps.
defaults write com.apple.dock persistent-apps -array

# Show only open applications in the Dock
#defaults write com.apple.dock static-only -bool true

# Don’t animate opening applications from the Dock
defaults write com.apple.dock launchanim -bool false

# Speed up Mission Control animations
defaults write com.apple.dock expose-animation-duration -float 0.1

# Disable Dashboard
defaults write com.apple.dashboard mcx-disabled -bool true

# Don’t show Dashboard as a Space
defaults write com.apple.dock dashboard-in-overlay -bool true

# Don’t automatically rearrange Spaces based on most recent use
defaults write com.apple.dock mru-spaces -bool false

# Remove the auto-hiding Dock delay
defaults write com.apple.dock autohide-delay -float 0
# Remove the animation when hiding/showing the Dock
defaults write com.apple.dock autohide-time-modifier -float 0

# Automatically hide and show the Dock
defaults write com.apple.dock autohide -bool true

# Disable hot corners
defaults write com.apple.dock wvous-br-corner -int 1

###############################################################################
# Safari & WebKit                                                             #
###############################################################################

# Privacy: don’t send search queries to Apple
defaults write com.apple.Safari UniversalSearchEnabled -bool false
defaults write com.apple.Safari SuppressSearchSuggestions -bool true

# Show the full URL in the address bar (note: this still hides the scheme)
defaults write com.apple.Safari ShowFullURLInSmartSearchField -bool true

# Set Safari’s home page to `about:blank` for faster loading
defaults write com.apple.Safari HomePage -string "about:blank"

# Allow hitting the Backspace key to go to the previous page in history
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2BackspaceKeyNavigationEnabled -bool true

# Prevent Safari from opening ‘safe’ files automatically after downloading
defaults write com.apple.Safari AutoOpenSafeDownloads -bool false

# Hide Safari’s bookmarks bar by default
defaults write com.apple.Safari ShowFavoritesBar -bool false

# Hide Safari’s sidebar in Top Sites
defaults write com.apple.Safari ShowSidebarInTopSites -bool false

# Disable Safari’s thumbnail cache for History and Top Sites
defaults write com.apple.Safari DebugSnapshotsUpdatePolicy -int 2

# Enable Safari’s debug menu
defaults write com.apple.Safari IncludeInternalDebugMenu -bool true

# Remove useless icons from Safari’s bookmarks bar
defaults write com.apple.Safari ProxiesInBookmarksBar "()"

# Enable the Develop menu and the Web Inspector in Safari
defaults write com.apple.Safari IncludeDevelopMenu -bool true
defaults write com.apple.Safari WebKitDeveloperExtrasEnabledPreferenceKey -bool true
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2DeveloperExtrasEnabled -bool true

# Add a context menu item for showing the Web Inspector in web views
defaults write NSGlobalDomain WebKitDeveloperExtras -bool true

# Disable AutoFill
defaults write com.apple.Safari AutoFillFromAddressBook -bool false
defaults write com.apple.Safari AutoFillPasswords -bool false
defaults write com.apple.Safari AutoFillCreditCardData -bool false
defaults write com.apple.Safari AutoFillMiscellaneousForms -bool false

# Enable “Do Not Track”
defaults write com.apple.Safari SendDoNotTrackHTTPHeader -bool true

###############################################################################
# Mail                                                                        #
###############################################################################

# Disable send and reply animations in Mail.app
defaults write com.apple.mail DisableReplyAnimations -bool true
defaults write com.apple.mail DisableSendAnimations -bool true

###############################################################################
# Terminal & iTerm 2                                                          #
###############################################################################

# Only use UTF-8 in Terminal.app
defaults write com.apple.terminal StringEncodings -array 4

# Enable Secure Keyboard Entry in Terminal.app
# See: https://security.stackexchange.com/a/47786/8918
defaults write com.apple.terminal SecureKeyboardEntry -bool true

# Don’t display the annoying prompt when quitting iTerm
defaults write com.googlecode.iterm2 PromptOnQuit -bool false

###############################################################################
# Photos                                                                      #
###############################################################################

# Prevent Photos from opening automatically when devices are plugged in
defaults -currentHost write com.apple.ImageCapture disableHotPlug -bool true

# Disable Photos app from launching on external camera connection
defaults write com.apple.Photos AutoShowFirstTimeExperience -bool false

###############################################################################
# Notifications & Focus (useful for stock trading)                           #
###############################################################################

# Disable notification center sounds
defaults write com.apple.notificationcenterui bannerTime -int 3

# Don't show Siri in menu bar
defaults write com.apple.Siri StatusMenuVisible -bool false

# Disable Notification Center
launchctl unload -w /System/Library/LaunchAgents/com.apple.notificationcenterui.plist 2>/dev/null || true

###############################################################################
# Messages                                                                    #
###############################################################################

# Disable automatic emoji substitution (i.e. use plain text smileys)
defaults write com.apple.messageshelper.MessageController SOInputLineSettings -dict-add "automaticEmojiSubstitutionEnablediMessage" -bool false

# Disable smart quotes as it’s annoying for messages that contain code
defaults write com.apple.messageshelper.MessageController SOInputLineSettings -dict-add "automaticQuoteSubstitutionEnabled" -bool false

# Disable continuous spell checking
defaults write com.apple.messageshelper.MessageController SOInputLineSettings -dict-add "continuousSpellCheckingEnabled" -bool false

###############################################################################
# Google Chrome & Google Chrome Canary                                        #
###############################################################################

# Disable the all too sensitive backswipe on trackpads
defaults write com.google.Chrome AppleEnableSwipeNavigateWithScrolls -bool false
defaults write com.google.Chrome.canary AppleEnableSwipeNavigateWithScrolls -bool false

# Disable the all too sensitive backswipe on Magic Mouse
defaults write com.google.Chrome AppleEnableMouseSwipeNavigateWithScrolls -bool false
defaults write com.google.Chrome.canary AppleEnableMouseSwipeNavigateWithScrolls -bool false

# Use the system-native print preview dialog
defaults write com.google.Chrome DisablePrintPreview -bool true
defaults write com.google.Chrome.canary DisablePrintPreview -bool true

# Expand the print dialog by default
defaults write com.google.Chrome PMPrintingExpandedStateForPrint2 -bool true
defaults write com.google.Chrome.canary PMPrintingExpandedStateForPrint2 -bool true

###############################################################################
# Startup items                                                               #
###############################################################################
defaults write com.runningwithcrayons.Alfred-Preferences syncfolder -string "~/My Drive/Apps/Alfred"

###############################################################################
# Startup items                                                               #
###############################################################################

osascript -e 'tell application "System Events" to make login item at end with properties {path:"/Applications/Hammerspoon.app", hidden:false}'
osascript -e 'tell application "System Events" to make login item at end with properties {path:"/Applications/Alfred.app", hidden:false}'
osascript -e 'tell application "System Events" to make login item at end with properties {path:"/Applications/Google Drive.app", hidden:false}'
osascript -e 'tell application "System Events" to make login item at end with properties {path:"/Applications/Spotify.app", hidden:false}'
osascript -e 'tell application "System Events" to make login item at end with properties {path:"/Applications/BetterTouchTool.app", hidden:false}'

###############################################################################
# Kill affected applications                                                  #
###############################################################################

for app in "Activity Monitor" \
	"Address Book" \
	"Calendar" \
	"cfprefsd" \
	"Contacts" \
	"Dock" \
	"Finder" \
	"Google Chrome Canary" \
	"Google Chrome" \
	"Mail" \
	"Messages" \
	"Opera" \
	"Photos" \
	"Safari" \
	"SystemUIServer" \
	"Terminal" \
	"iCal"; do
	killall "${app}" &> /dev/null
done
echo "Done. Note that some of these changes require a logout/restart to take effect."
